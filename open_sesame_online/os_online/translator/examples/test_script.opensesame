# Generated by OpenSesame 2.8.2~pre3 (Gutsy Gibson)
# Tue May 13 14:41:33 2014 (posix)
# <http://www.cogsci.nl/opensesame>

set mouse_backend "legacy"
set subject_parity "even"
set height "768"
set font_family "mono"
set font_italic "no"
set synth_backend "legacy"
set title "OpenSesame online test script"
set coordinates "relative"
set start "experiment"
set sampler_backend "legacy"
set transparent_variables "no"
set foreground "white"
set font_bold "no"
set description "A number of tests for OpenSesame online"
set both_level_variable "experiment level"
set background "black"
set font_size "18"
set keyboard_backend "legacy"
set canvas_backend "legacy"
set experiment_level_variable "experiment level"
set compensation "0"
set bidi "no"
set subject_nr "0"
set width "1024"

define loop block_loop
	set repeat "1"
	set description "Repeatedly runs another item"
	set item "trial_sequence"
	set break_if "never"
	set column_order "correct_response"
	set cycles "6"
	set order "random"
	setcycle 0 correct_response "left"
	setcycle 1 correct_response "right"
	setcycle 2 correct_response "a"
	setcycle 3 correct_response "b"
	setcycle 4 correct_response "space"
	setcycle 5 correct_response "None"
	run trial_sequence

define sketchpad choose_test
	set duration "keypress"
	set description "Displays stimuli"
	draw textline 0 -256 "Choose a test" center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"
	draw textline 0 -160 "1. Test form_text_display" center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"
	draw textline 0 -32 "3. Test sketchpad" center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"
	draw textline 0 288 "Press 'a' to run all tests" center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"
	draw textline 0 -96 "2. Test flow (variables, loops, and sequences)" center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"
	draw textline 0 32 "4. Test variable resolution (experiment vs item level)" center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"
	draw textline 0.0 160.0 "For comparison, run these tests in OpenSesame >= 2.8.1" center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"

define sequence experiment
	run choose_test "always"
	run form_text_display "[response] = 1 or [response] = a"
	run block_loop "[response] = 2 or [response] = a"
	run sketchpad_test "[response] = 3 or [response] = a"
	run variable_scope_test "[response] = 4 or [response] = a"

define form_text_display form_text_display
	set rows "1;4;1"
	set description "A simple text display form"
	__form_text__
	OpenSesame supports a sub-set of HTML tags:
	- <b>Bold face</b>
	- <i>Italic</i>
	- <u>Underline</u>
	
	In addition, you can pass 'color', 'size', and 'style' as keywords to a 'span' tag:
	- <span color="red">Color</span>
	- <span size="32">Font size</span>
	- <span style="serif">Font style</span>
	
	Finally, you can force newlines with the 'br' tag:
	Line 1<br>Line 2
	__end__
	set cols "1;1;1"
	set form_title "Form-title text"
	set ok_text "Ok-button text"
	widget 0 0 3 1 label text="[form_title]"
	widget 0 1 3 1 label center="no" text="[form_text]"
	widget 1 2 1 1 button text="[ok_text]"


define keyboard_response keyboard_response
	set allowed_responses "left;right;a;b;space;q"
	set description "Collects keyboard responses"
	set timeout "2000"
	set flush "yes"

define sketchpad run_after_correct
	set duration "500"
	set description "Displays stimuli"
	draw textline 0 0 "Correct!" center=1 color=green font_family="mono" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"

define sketchpad run_after_incorrect
	set duration "500"
	set description "Displays stimuli"
	draw textline 0 0 "Incorrect!" center=1 color=red font_family="mono" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"

define sketchpad run_after_timeout
	set duration "500"
	set description "Displays stimuli"
	draw textline 0 0 "Timeout!" center=1 color=orange font_family="mono" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"

define sketchpad sketchpad
	set duration "0"
	set description "Displays stimuli"
	draw textline 0 0 "Press the left key" center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="[correct_response] == left" html="yes"
	draw textline 0 0 "Press the right key" center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="[correct_response] == right" html="yes"
	draw textline 0 0 "Press 'a'" center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="[correct_response] == 'a'" html="yes"
	draw textline 0 0 "Press 'b'" center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="[correct_response] == b" html="yes"
	draw textline 0 0 "Press the space bar" center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="[correct_response] == 'space'" html="yes"
	draw textline 0 0 "Wait for timeout" center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="[correct_response] == None" html="yes"
	draw textline 0 -224 "Pressing q should abort the loop" center=1 color=white font_family="mono" font_size=12 font_italic=no font_bold=no show_if="always" html="yes"
	draw textline 0 -288 "Pressing any other key than left, right, a, b, q, or space should be ignored" center=1 color=white font_family="mono" font_size=12 font_italic=no font_bold=no show_if="always" html="yes"
	draw textline 0 -160 "A timeout should occur after 2000 ms" center=1 color=white font_family="mono" font_size=12 font_italic=no font_bold=no show_if="always" html="yes"

define sketchpad sketchpad_test
	set duration "keypress"
	set start_response_interval "no"
	set background "#2e3436"
	set description "Displays stimuli"
	draw line -448 -320 -352 -320 penwidth=1 color=white show_if="always"
	draw line -448 -288 -352 -288 penwidth=2 color=white show_if="always"
	draw line -448 -256 -352 -256 penwidth=3 color=white show_if="always"
	draw line -448 -224 -352 -224 penwidth=4 color=white show_if="always"
	draw line -448 -192 -352 -192 penwidth=8 color=white show_if="always"
	draw line -448 -160 -352 -160 penwidth=16 color=white show_if="always"
	draw line -320 -320 -320 -224 penwidth=2 color=red show_if="always"
	draw line -320 -320 -288 -224 penwidth=2 color=green show_if="always"
	draw line -320 -320 -256 -224 penwidth=2 color=yellow show_if="always"
	draw line -320 -320 -256 -256 penwidth=2 color=#ff8000 show_if="always"
	draw line -320 -320 -256 -288 penwidth=2 color=#c000c0 show_if="always"
	draw line -320 -320 -256 -320 penwidth=2 color=#808080 show_if="always"
	draw textline 0 -320 "mono 18 centered" center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"
	draw textline 0 -288 "mono 18 left aligned" center=0 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"
	draw textline 0 -224 "mono 12" center=1 color=white font_family="mono" font_size=12 font_italic=no font_bold=no show_if="always" html="yes"
	draw textline 0 -128 "sans 18" center=1 color=white font_family="sans" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"
	draw textline 0 -96 "serif 18" center=1 color=white font_family="serif" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"
	draw textline 192 -224 "sans 18 italic" center=1 color=white font_family="sans" font_size=18 font_italic=yes font_bold=no show_if="always" html="yes"
	draw textline 192 -192 "sans 18 bold" center=1 color=white font_family="sans" font_size=18 font_italic=no font_bold=yes show_if="always" html="yes"
	draw textline 192 -160 "sans 18 italic bold" center=1 color=white font_family="sans" font_size=18 font_italic=yes font_bold=yes show_if="always" html="yes"
	draw textline 0 -192 "mono 18 green" center=1 color=#00FF00 font_family="mono" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"
	draw textline 0 352 "Press any key to continue" center=1 color=white font_family="sans" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"
	draw arrow -192 -320 -192 -224 penwidth=2 color=white arrow_size=10 show_if="always"
	draw arrow -160 -224 -224 -320 penwidth=4 color=green arrow_size=24 show_if="always"
	draw rect -448 -64 64 64 fill=0 penwidth=1 color=white show_if="always"
	draw rect -352 -64 64 64 fill=0 penwidth=1 color=green show_if="always"
	draw rect -448 32 64 64 fill=0 penwidth=4 color=white show_if="always"
	draw rect -352 32 64 64 fill=1 penwidth=1 color=white show_if="always"
	draw rect -256 -64 64 64 fill=1 penwidth=1 color=#FF0000 show_if="always"
	draw ellipse -256 32 64 64 fill=1 penwidth=1 color=#FF0000 show_if="always"
	draw ellipse -160 32 64 64 fill=1 penwidth=1 color=white show_if="always"
	draw ellipse -64 32 64 64 fill=0 penwidth=4 color=white show_if="always"
	draw ellipse -64 -64 64 64 fill=0 penwidth=1 color=white show_if="always"
	draw ellipse -160 -64 64 64 fill=0 penwidth=1 color=green show_if="always"
	draw circle 160 -32 64 fill=0 penwidth=1 color=green show_if="always"
	draw circle 64 -32 64 fill=0 penwidth=1 color=white show_if="always"
	draw circle 64 64 64 fill=0 penwidth=4 color=white show_if="always"
	draw circle 160 64 64 fill=1 penwidth=1 color=white show_if="always"
	draw circle 256 64 64 fill=1 penwidth=1 color=#FF0000 show_if="always"
	draw ellipse -256 128 64 96 fill=1 penwidth=1 color=#FF0000 show_if="always"
	draw ellipse -192 128 128 32 fill=1 penwidth=1 color=white show_if="always"
	draw ellipse -192 192 128 32 fill=0 penwidth=1 color=white show_if="always"
	draw ellipse -192 160 128 32 fill=0 penwidth=4 color=green show_if="always"
	draw line 0 -352 0 -64 penwidth=1 color=gray show_if="always"
	draw fixdot -448 160 color=white show_if="always"
	draw fixdot -448 192 color=red show_if="always"
	draw fixdot -416 160 color=#00FF00 show_if="always"
	draw noise 64 224 env=gaussian size=96 stdev=12 color1=white color2=black bgmode=avg show_if="always"
	draw noise 192 224 env=linear size=96 stdev=12 color1=white color2=black bgmode=avg show_if="always"
	draw noise 320 224 env=circular size=96 stdev=12 color1=white color2=black bgmode=avg show_if="always"
	draw noise 448 224 env=rectangle size=96 stdev=12 color1=white color2=black bgmode=avg show_if="always"
	draw gabor 448 96 orient=0 freq=0.1 env=rectangle size=96 stdev=12 phase=0 color1=white color2=black bgmode=avg show_if="always"
	draw gabor 448 -32 orient=30 freq=0.05 env=circular size=96 stdev=12 phase=0 color1=white color2=black bgmode=avg show_if="always"
	draw gabor 448 -160 orient=-30 freq=0.05 env=linear size=96 stdev=12 phase=0 color1=white color2=black bgmode=avg show_if="always"
	draw gabor 448 -288 orient=90 freq=0.01 env=gaussian size=96 stdev=24 phase=0 color1=white color2=black bgmode=avg show_if="always"

define sequence trial_sequence
	set flush_keyboard "yes"
	set description "Runs a number of items in sequence"
	run sketchpad "always"
	run keyboard_response "always"
	run run_after_correct "[correct] = 1 and [response] != q"
	run run_after_incorrect "[correct] = 0 and [response] != None and [response] != q"
	run run_after_timeout "[response] = None and [response] != q"

define sequence variable_scope_test
	set flush_keyboard "yes"
	set description "Runs a number of items in sequence"
	run variable_scope_test_1 "always"
	run variable_scope_test_2 "always"

define sketchpad variable_scope_test_1
	set duration "keypress"
	set description "Displays stimuli"
	set item_level_variable "item level"
	draw textline 0 -288 "item_level_variable: [item_level_variable] (expect: item level)" center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"
	draw textline 0 -224 "experiment_level_variable: [experiment_level_variable] (expect: experiment level)" center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"
	draw textline 0 -160 "both_level_variable: [both_level_variable] (expect: experiment level)" center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"
	draw textline 0 320 "Press any key to continue ..." center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"

define sketchpad variable_scope_test_2
	set duration "keypress"
	set description "Displays stimuli"
	set item_level_variable "item level"
	set both_level_variable "item level"
	draw textline 0 320 "Press any key to continue ..." center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"
	draw textline 0 -288 "item_level_variable: [item_level_variable] (expect: item level)" center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"
	draw textline 0 -224 "experiment_level_variable: [experiment_level_variable] (expect: experiment level)" center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"
	draw textline 0 -160 "both_level_variable: [both_level_variable] (expect: item level)" center=1 color=white font_family="mono" font_size=18 font_italic=no font_bold=no show_if="always" html="yes"

